name: build.push.deploy.lib.unb.ca

on:
  pull_request:
  push:
  workflow_dispatch:

jobs:
  deploy:
    uses: unb-libraries/dockworker/.github/workflows/deploy/workflow.yaml@6.x
    with:
      branch-env-map: '{"prod":"prod"}'
      deploy-branches: '["prod"]'
      k8s-deployment-name: 'lib-unb-ca'
      push-branches: '["prod"]'
    secrets:
      AWS_SECURITY_GROUP_ID: ${{ secrets.AWS_SECURITY_GROUP_ID }}
      AWS_SECURITY_GROUP_MODIFIER_ACCESS_KEY_ID: ${{ secrets.AWS_SECURITY_GROUP_MODIFIER_ACCESS_KEY_ID }}
      AWS_SECURITY_GROUP_MODIFIER_SECRET_KEY: ${{ secrets.AWS_SECURITY_GROUP_MODIFIER_SECRET_KEY }}
      AWS_SECURITY_GROUP_REGION: ${{ secrets.AWS_SECURITY_GROUP_REGION }}
      KUBE_CONFIG: ${{ secrets.KUBE_CONFIG }}
      SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
